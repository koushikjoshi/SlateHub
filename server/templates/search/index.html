{% extends "_layout.html" %}
{% block title %}
    Search -
    {{ app_name }}
{% endblock %}
{% block page_name %}
    search
{% endblock %}
{% block content %}
    <section id="section-search" data-component="search">
        <header id="search-header" data-role="section-header">
            <hgroup>
                <h1 id="heading-search">Search</h1>
                <p data-role="subtitle">
                    Find people, organizations, locations, and productions
                </p>
            </hgroup>
        </header>
        <form id="form-search" method="get" action="/search" data-component="search-form">
            <div id="field-search-query" data-field="query">
                <label for="input-search-query">What are you looking for?</label>
                <input
                type="search"
                id="input-search-query"
                name="q"
                placeholder="e.g., 'male actor ages 20-40 in Berlin' or 'modern office in Los Angeles with lots of light'"
                value="{% match query %}{% when Some with (q) %}{{ q }}{% when None %}{% endmatch %}"
                aria-describedby="help-search-query"
                autofocus
            />
                <small id="help-search-query" data-role="help-text">
                    Use natural language to describe what you're looking for.
                    
                    
                    
                    
                    
                    
                    
                                                            Our AI-powered
                    
                    
                    
                    
                    
                    
                    
                    search understands
                    
                    
                    
                    
                    
                    
                    
                                        context.
                </small>
            </div>
            <div id="search-actions" data-role="form-actions">
                <button type="submit" id="button-submit-search" data-type="primary">Search</button>
            </div>
        </form>
    </section>
    {% if has_results %}
        <section id="section-search-results" data-component="search-results">
            <header id="results-header" data-role="section-header">
                <h2 id="heading-results">Search Results</h2>
                <p data-role="result-count">
                    Found
                    {{ total_results }}
                    result
                    {% if total_results != 1 %}
                        s
                    {% endif %}
                </p>
            </header>
            {% if !people.is_empty() %}
                <section id="results-people" data-result-type="people">
                    <header data-role="subsection-header">
                        <h3 id="heading-people-results">People</h3>
                    </header>
                    <ul data-role="results-list" data-layout="grid">
                        {% for person in people %}
                            <li data-item="true" data-item-id="{{ person.id }}">
                                <article data-component="person-card" data-person-id="{{ person.id }}">
                                    <header data-role="card-header">
                                        {% match person.avatar_url %}
                                            {% when Some with (url) %}
                                            <img src="{{ url }}" alt="{{ person.name }}" data-role="avatar" />
                                            {% when None %}
                                            <div data-role="avatar-initials">{{ person.initials }}</div>
                                        {% endmatch %}
                                        <h4 id="person-name-{{ person.id }}">
                                            <a href="/{{ person.username }}">{{ person.name }}</a>
                                        </h4>
                                        {% match person.headline %}
                                            {% when Some with (headline) %}
                                            <p data-role="headline">{{ headline }}</p>
                                            {% when None %}
                                        {% endmatch %}
                                    </header>
                                    <div data-role="card-body">
                                        {% match person.location %}
                                            {% when Some with (location) %}
                                            <p data-role="location">{{ location }}</p>
                                            {% when None %}
                                        {% endmatch %}
                                        {% if !person.skills.is_empty() %}
                                            <ul data-role="skills-list">
                                                {% for skill in person.skills %}
                                                    <li data-role="skill">{{ skill }}</li>
                                                {% endfor %}
                                            </ul>
                                        {% endif %}
                                        <p data-role="match-score">Match: {{ person.score }}%</p>
                                    </div>
                                </article>
                            </li>
                        {% endfor %}
                    </ul>
                </section>
            {% endif %}
            {% if !organizations.is_empty() %}
                <section id="results-organizations" data-result-type="organizations">
                    <header data-role="subsection-header">
                        <h3 id="heading-organizations-results">Organizations</h3>
                    </header>
                    <ul data-role="results-list" data-layout="grid">
                        {% for org in organizations %}
                            <li data-item="true" data-item-id="{{ org.id }}">
                                <article data-component="organization-card" data-organization-id="{{ org.id }}">
                                    <header data-role="card-header">
                                        {% match org.logo %}
                                            {% when Some with (logo) %}
                                            <img src="{{ logo }}" alt="{{ org.name }}" data-role="logo" />
                                            {% when None %}
                                        {% endmatch %}
                                        <h4 id="org-name-{{ org.id }}">
                                            <a href="/org/{{ org.slug }}">{{ org.name }}</a>
                                        </h4>
                                    </header>
                                    <div data-role="card-body">
                                        {% match org.description %}
                                            {% when Some with (description) %}
                                            <p data-role="description">{{ description }}</p>
                                            {% when None %}
                                        {% endmatch %}
                                        {% match org.location %}
                                            {% when Some with (location) %}
                                            <p data-role="location">{{ location }}</p>
                                            {% when None %}
                                        {% endmatch %}
                                        <p data-role="match-score">Match: {{ org.score }}%</p>
                                    </div>
                                </article>
                            </li>
                        {% endfor %}
                    </ul>
                </section>
            {% endif %}
            {% if !locations.is_empty() %}
                <section id="results-locations" data-result-type="locations">
                    <header data-role="subsection-header">
                        <h3 id="heading-locations-results">Locations</h3>
                    </header>
                    <ul data-role="results-list" data-layout="grid">
                        {% for location in locations %}
                            <li data-item="true" data-item-id="{{ location.id }}">
                                <article data-component="location-card" data-location-id="{{ location.id }}">
                                    <header data-role="card-header">
                                        <h4 id="location-name-{{ location.id }}">
                                            <a href="/locations/{{ location.id }}">{{ location.name }}</a>
                                        </h4>
                                    </header>
                                    <div data-role="card-body">
                                        <p data-role="address">{{ location.address }}</p>
                                        <p data-role="city">
                                            {{ location.city }}
                                            ,
                                            {{ location.state }}
                                        </p>
                                        {% match location.description %}
                                            {% when Some with (description) %}
                                            <p data-role="description">{{ description }}</p>
                                            {% when None %}
                                        {% endmatch %}
                                        <p data-role="match-score">Match: {{ location.score }}%</p>
                                    </div>
                                </article>
                            </li>
                        {% endfor %}
                    </ul>
                </section>
            {% endif %}
            {% if !productions.is_empty() %}
                <section id="results-productions" data-result-type="productions">
                    <header data-role="subsection-header">
                        <h3 id="heading-productions-results">Productions</h3>
                    </header>
                    <ul data-role="results-list" data-layout="grid">
                        {% for production in productions %}
                            <li data-item="true" data-item-id="{{ production.id }}">
                                <article data-component="production-card" data-production-id="{{ production.id }}">
                                    <header data-role="card-header">
                                        <h4 id="production-title-{{ production.id }}">
                                            <a href="/productions/{{ production.id }}">{{ production.title }}</a>
                                        </h4>
                                        <span data-role="status-badge" data-status="{{ production.status }}">{{ production.status }}</span>
                                    </header>
                                    <div data-role="card-body">
                                        {% match production.description %}
                                            {% when Some with (description) %}
                                            <p data-role="description">{{ description }}</p>
                                            {% when None %}
                                        {% endmatch %}
                                        {% match production.location %}
                                            {% when Some with (location) %}
                                            <p data-role="location">{{ location }}</p>
                                            {% when None %}
                                        {% endmatch %}
                                        <p data-role="match-score">Match: {{ production.score }}%</p>
                                    </div>
                                </article>
                            </li>
                        {% endfor %}
                    </ul>
                </section>
            {% endif %}
        </section>
    {% else %}
        {% match query %}
            {% when Some with (q) %}
            <section id="section-no-results" data-state="empty">
                <div data-role="empty-state">
                    <p>
                        No results found for "
                        {{ q }}
                        "
                    </p>
                    <p data-role="help-text">
                        Try a different search term or be more specific about what you're looking for.
                    </p>
                </div>
            </section>
            {% when None %}
        {% endmatch %}
    {% endif %}
{% endblock %}
